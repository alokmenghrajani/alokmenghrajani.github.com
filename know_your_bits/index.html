<!DOCTYPE html>
<html lang="en">
<head>
  <title>Alok Menghrajani's stuff | bit manipulation puzzle</title>
  <meta property="fb:admins" content="536181839"/>
  <meta name="author" content="Alok Menghrajani"/>
  <link href="../bootstrap-2.3.1.min.css" rel="stylesheet"/>
  <script type="text/javascript" src="../jquery-1.7.1.min.js"></script>
  <script type="text/javascript" src="myparser.js"></script>
<style>
.menu {
  top: 40px;
  position: fixed;
}
.profile {
  position: relative;
  left: -170px;
  overflow: visible;
}
.container-narrow {
  margin: 0 auto;
  width: 700px;
}
.jumbotron h1 {
  font-size: 32px;
}
section {
  padding-top: 20px;
}
body { margin-top: 40px; }
section { padding-top: 20px; }
footer { padding-top: 40px; }
#line-error {
  float: left;
  font-family: courier;
  font-size: 14px;
  white-space: pre;
  color: white;
}
#cmd {
  font-family: courier;
  font-size: 14px;
  background: black;
  color: #21f838;
  padding: 5px;
  padding-left: 30px;
  height: 300px;
}
#cmd span {
  padding-left: 0;
  white-space: pre;
}
#cursor {
  width: 2px;
  margin-left: -1px;
  margin-right: -1px;
  height: 14px;
  background: #21f838;
  display: inline-block;
}
#highlight {
  background: #01a808;
}
#text-placeholder {
  position: absolute;
}
#line-error {
  padding-top: 4px;
}
#text {
  position: relative;
  float: left;
  font-family: courier;
  font-size: 14px;
  opacity: 0;
  top: 60px;
  left: 21px;
  width: 660px;
  height: 240px;
}
</style>
</head>
<body>
<div class="container-narrow">
  <div class="menu">
    <div class="profile">
      <p class="pull-right"><a href="../">&larr; Back to home</a></p>
    </div>
  </div>
  <div class="jumbotron">
    <h1>Do you know your bitwise operators?</h1>
    <div class="lead">
      <p>
        Most programming languages offer various bit level manipulation
        operators (bitwise and, bitwise or, shifting to the right or to the left, etc.).
      </p>
      <p>
        Puzzles like this one are a great way to learn about
        the bit level representation of numbers and the various bit related
        operators.
      </p>
      <p>
        This puzzle requires you to implement a piece of code with only a limited
        set of operators.
      <p>
        Your solution to the puzzles gets validated automatically and your score
        is based on the total length of your code (lower score is better).
      </p>
    </div>
  </div>

  <section>
    <div class="page-header"><h3>Return true iff x contains exactly one bit set to 1</h3></div>
    <div>Allowed operators: <code>! &tilde; &amp; ^ | + &lt;&lt; &gt;&gt; &gt;&gt;&gt;</code></div>
    <br/>
    <p>
      Write a function which returns 1 if x contains exactly one bit set to 1. It should return
      0 if x is zero or contains more than one bit set to 1.
    </p>
    <p>
      You can assign intermediate results to as many variables as you need (assignments don't
      count towards your score) and you
      can use constants in the 0-255 range.
    </p>
    <p>Go ahead, and write your code below. Hit validate when you are done!</p>

    <div id="line-error"></div>
    <div id="text-placeholder"><textarea id="text"></textarea></div>
    <div id="cmd" onclick="$('#text').focus()" onload="$(this).focus()">
      <span>function one_bit(x) {
  // write your code here
  // end it with a return statement
</span>
      <span id="before"></span><span id="cursor" style="visibility:hidden"></span><span id="highlight"></span><span id="after"></span>
      <span>
}</span>
    </div>

    <br/>
    <div class="alert alert-error" id="error" style="display: none"></div>
    <div class="alert alert-success" id="score" style="display: none"></div>

    <button onclick="validate(7, {x:1})">validate</button>
  </section>

  <section>
    <div class="page-header"><h3>Hint</h3></div>
    <p>Here is some information on what each operator does:</p>
    <p>
    <table>
      <tr><td><code>!x</code> (logical not):</td><td>Returns 1 if x is 0. Returns 0 is x is != 0.</td></tr>
      <tr><td><code>&tilde;x</code> (bitwise not):</td><td>Flips all the bits in x.</td>
      <tr><td><code>x&amp;y</code> (bitwise and):</td><td>For each bit in x,y, sets the result's bit to 1 if both x and y have their bit set.</td></tr>
      <tr><td><code>x^y</code> (bitwise xor):</td><td>For each bit in x,y, sets the result's bit to 1 if x or y, but not both, have their bit set.</td></tr>
      <tr><td><code>x|y</code> (bitwise or):</td><td>For each bit in x,y, sets the result's bit to 1 if x or y have their bit set.</td></tr>
      <tr><td><code>x+y</code> (addition):</td><td>Adds x and y.</td></tr>
      <tr><td><code>x&lt;&lt;n</code> (bitwise shift left):</td><td>Shifts the bits in x to the left, by n bits.</td></tr>
      <tr><td><code>x&gt;&gt;n</code> (bitwise shift right):</td><td>Shifts the bits in x to the right, by n bits. The sign is maintained.</td></tr>
      <tr><td><code>x&gt;&gt;&gt;n</code> (logical shift right):</td><td>Shifts the bits in x to the right, by n bits. Zeros are filled in from the left.</td></tr>
    </table>
    </p>
    <p>
      Note: A useful trick is <code>-x = ~x+1</code>!
    </p>
    <p>
      Fun fact: JavaScript is a funny beast, the language does not really expose
      integers (all math operators return numerical values).
      The language does implement these various bit manipulation operators, which
      treat their operands as 32 bits (and return a numerical value).
    </p>
  </section>

  <section>
    <div class="page-header"><h3>links</h3></div>
    <p>More similar puzzles:</p>
    <ul>
      <li><a href="http://www.cs.cmu.edu/afs/cs/academic/class/15213-f02/www/L1.html">http://www.cs.cmu.edu/afs/cs/academic/class/15213-f02/www/L1.html</a></li>
      <li><a href="http://csapp.cs.cmu.edu/public/datalab.pdf">http://csapp.cs.cmu.edu/public/datalab.pdf</a></li>
    </ul>
  </section>

  <footer class="footer">
    <p class="pull-right"><a href="#">Back to top &uarr;</a></p>
  </footer>
</div>

<script>
function f() {
  var cursor;
  $('#text').focus(function() {
    $('#cursor').css({ visibility: 'visible' });
    cursor = window.setInterval(function() {
      if ($('#cursor').css('visibility') === 'visible') {
        $('#cursor').css({ visibility: 'hidden' });
      } else {
        $('#cursor').css({ visibility: 'visible' });
      }
    }, 500);
  });
$('#text').keyup(function() {
  var start = $('#text')[0].selectionStart;
  var end = $('#text')[0].selectionEnd;
  var text = $(this).val();
  $('#before').text(text.substr(0, start));
  $('#highlight').text(text.substr(start, end-start));
  $('#after').text(text.substr(end));
});
$('#text').click(function() {
  var start = $('#text')[0].selectionStart;
  var end = $('#text')[0].selectionEnd;
  var text = $(this).val();
  $('#before').text(text.substr(0, start));
  $('#highlight').text(text.substr(start, end-start));
  $('#after').text(text.substr(end));
});
$('#text').blur(function() {
  clearInterval(cursor);
  $('#cursor').css({visibility: 'hidden'});
});
}
f();

function validate_operator(op) {
  if (op == "return") { return 0; }
  if (op == "=") { return 0; }
  if (["!", "~", "&", "^", "|", "+", "<<", ">>", ">>>"].indexOf(op) == -1) {
    throw {message:"You are using an invalid operator: "+op};
  }
  return 1;
}

function validate_correctness(input) {
  eval("var f1=function(x){"+input+"};");
  var f2 = function(x) {
    var c = 0;
    for (var i=0; i<32; i++) {
      c += (x >> i) & 1;
    }
    return c==1;
  };

  var x = [0, -1, 1, 2, -2, 10, -11, 7, -2147483648, 2147483647];
  for (var i=0; i<10; i++) {
    x.push(((Math.random()* 4294967296)-2147483648) & 0xffffffff);
  }
  for (var i=0; i<x.length; i++) {
    r1 = f1(x[i]) & 0xffffffff;
    r2 = f2(x[i]) & 0xffffffff;
    if (r1 != r2) {
      throw {message: "Solution did not return correct output for x="+x[i]+
                      ". Expected output: "+r2+", got: "+r1}
    }
  }
}
</script>
<script type="text/javascript" src="myvalidate.js"/>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2373559-12', 'quaxio.com');
  ga('send', 'pageview');
</script>

</body>
</html>
